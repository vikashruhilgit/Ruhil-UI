{"version":3,"file":"DateTable.js","sourceRoot":"","sources":["../../../../src/component/data-table/DateTable.ts"],"names":[],"mappings":"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","sourcesContent":["/* eslint-disable no-return-assign */\nimport { html, LitElement, render } from 'lit';\nimport { property, state } from 'lit/decorators.js';\nimport { guard } from 'lit/directives/guard.js';\n\nimport { GridItemModel, Grid, GridActiveItemChangedEvent } from '@vaadin/grid';\n\nimport '@vaadin/grid/theme/material/vaadin-grid.js';\nimport '@vaadin/grid/theme/material/vaadin-grid-filter-column.js';\nimport '@vaadin/grid/theme/material/vaadin-grid-selection-column.js';\nimport '@vaadin/grid/theme/material/vaadin-grid-sort-column.js';\nimport '@vaadin/grid/theme/material/vaadin-grid-tree-column.js';\n\nimport { styles } from './DateTable.css';\nimport { camelCaseToString, eventObj } from '../../utility/util';\n\nexport interface TableHeaderObj {\n  id: string;\n  label?: string;\n  type?: 'ACTION' | 'SHARE-DOWMLOAD';\n  alwaysShow?: boolean;\n}\n\nexport class DataTable extends LitElement {\n  @property({ type: Array }) tableData: any;\n\n  @property({ type: Boolean }) multiSort: boolean = false;\n\n  @property({ type: Boolean }) columnReorderingAllowed: boolean = false;\n\n  @property({ type: Boolean }) allRowsVisible: boolean = false;\n\n  @property({ type: Array }) actionItems: string[] = [];\n\n  @property({ type: Boolean }) enableExpansion: boolean = false;\n\n  @property({ type: Array }) headData: TableHeaderObj[] = [];\n\n  private hideColumn: boolean = false;\n\n  @state()\n  private detailsOpenedItem: any = [];\n\n  static styles = styles;\n\n  private actionRenderer = (\n    root: HTMLElement,\n    _: HTMLElement,\n    model: GridItemModel<any>\n  ) => {\n    render(\n      html`\n        <ft-table-menu-wrapper\n          .actionItems=\"${this.actionItems}\"\n          .model=${model}\n        ></ft-table-menu-wrapper>\n      `,\n      root\n    );\n  };\n\n  private iconClickHandler = (model: GridItemModel<any>, icon: string) => {\n    const eventData = { icon, ...model?.item };\n    this.dispatchEvent(eventObj('ft:table-icon-clicked', eventData));\n  };\n\n  private renderShareAndDownloadIcons = (model: GridItemModel<any>) => html`\n    <div class=\"dt-share-download\">\n      <ft-icon\n        @click=${() => this.iconClickHandler(model, 'share')}\n        class=\"dt-share-icon\"\n        >share</ft-icon\n      >\n      <ft-icon\n        @click=${() => this.iconClickHandler(model, 'download')}\n        class=\"dt-download-icon\"\n        >download</ft-icon\n      >\n    </div>\n  `;\n\n  protected firstUpdated(): void {\n    const grid: any = this.shadowRoot?.querySelector('vaadin-grid');\n    const table: any = grid?.shadowRoot?.querySelector('table');\n    if (table) {\n      table.addEventListener('scroll', () => {\n        setTimeout(() => {\n          if (grid.getAttribute('overflow') === 'top') {\n            this.dispatchEvent(eventObj('ft:table-scroll-end', { end: true }));\n          }\n        });\n      });\n    }\n  }\n\n  private shareRenderer = (\n    root: HTMLElement,\n    _: HTMLElement,\n    model: GridItemModel<any>\n  ) => {\n    render(this.renderShareAndDownloadIcons(model), root);\n  };\n\n  private expansionRenderer = (\n    root: HTMLElement,\n    _: HTMLElement,\n    model: GridItemModel<any>\n  ) => {\n    render(\n      html`\n        <div class=\"dt-expansion-download\">\n          ${model.detailsOpened\n            ? html` <ft-icon class=\"dt-less-icon\">expand_less</ft-icon>`\n            : html` <ft-icon class=\"dt-more-icon\">expand_more</ft-icon>`}\n        </div>\n      `,\n      root\n    );\n  };\n\n  private renderTable = (head: TableHeaderObj[]) => {\n    const rows = head.map((single: TableHeaderObj) => {\n      switch (single.type) {\n        case 'ACTION':\n          return html`<vaadin-grid-sort-column\n            header=\"Action\"\n            text-align=\"center\"\n            flex-grow=\"0\"\n            .hidden=${this.hideColumn}\n            .renderer=\"${this.actionRenderer}\"\n          ></vaadin-grid-sort-column>`;\n        case 'SHARE-DOWMLOAD':\n          return html`<vaadin-grid-sort-column\n            header=\"Share or Download\"\n            .hidden=${this.hideColumn}\n            .renderer=\"${this.shareRenderer}\"\n          ></vaadin-grid-sort-column>`;\n        default:\n          return html` <vaadin-grid-sort-column\n            header=\"${single.label ? single.label : ''}\"\n            auto-width\n            flex-grow=\"1\"\n            path=\"${single.id}\"\n            .hidden=${this.hideColumn && !single.alwaysShow}\n            .alwaysShow=\"${single.alwaysShow}\"\n          ></vaadin-grid-sort-column>`;\n      }\n    });\n\n    if (this.hideColumn) {\n      rows.push(html` <vaadin-grid-sort-column\n        header=\"\"\n        text-align=\"center\"\n        flex-grow=\"0\"\n        .renderer=\"${this.expansionRenderer}\"\n      >\n      </vaadin-grid-sort-column>`);\n    }\n    return rows;\n  };\n\n  private renderExpansionDetails = (model: GridItemModel<any>) => {\n    const renderItems = this.headData\n      .filter((single: TableHeaderObj) => !single.alwaysShow && !single.type)\n      .map(\n        (single: TableHeaderObj) =>\n          html`\n            <div class=\"dt-table-expansion\">\n              <p>\n                ${single.label ? single.label : camelCaseToString(single.id)}\n              </p>\n            </div>\n            <div>\n              <p class=\"dt-table-expansion-values\">${model.item[single.id]}</p>\n            </div>\n          `\n      );\n\n    return html`<div class=\"dt-expansion-container\">\n      <div class=\"dt-expansion-detail\">${renderItems}</div>\n      <div class=\"dt-expansion-action-warpper\">\n        <div class=\"dt-expansion-share\">\n          ${this.renderShareAndDownloadIcons(model)}\n        </div>\n        <div class=\"dt-expansion-action\">\n          <ft-table-menu-wrapper\n            .actionItems=\"${this.actionItems}\"\n            .model=${model}\n          ></ft-table-menu-wrapper>\n        </div>\n      </div>\n    </div>`;\n  };\n\n  render = () => {\n    if (this.enableExpansion && window.screen.width < 768) {\n      this.hideColumn = true;\n    }\n    return html`<vaadin-grid\n      class=\"ft-table-grid\"\n      .detailsOpenedItems=\"${this.hideColumn ? this.detailsOpenedItem : null}\"\n      @active-item-changed=\"${this.hideColumn\n        ? (e: GridActiveItemChangedEvent<any>) =>\n            (this.detailsOpenedItem = [e.detail.value])\n        : null}\"\n      .rowDetailsRenderer=\"${this.hideColumn\n        ? guard(\n            [],\n            () => (root: HTMLElement, _: Grid, model: GridItemModel<any>) => {\n              // TODO: remove -this and use obj for values\n              // eslint-disable-next-line @typescript-eslint/no-unused-vars\n              render(this.renderExpansionDetails(model), root);\n            }\n          )\n        : null}\"\n      .items=\"${this.tableData}\"\n      .multiSort=${this.multiSort}\n      .allRowsVisible=${this.allRowsVisible}\n      .columnReorderingAllowed=${this.columnReorderingAllowed}\n    >\n      ${this.renderTable(this.headData)}\n    </vaadin-grid>`;\n  };\n}\n"]}